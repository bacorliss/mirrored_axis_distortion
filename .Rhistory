g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "A_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "A_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# Linear visualization
base_dir = "mirror_fc"
fig_num = "3"
fig_path = paste(base_dir,"/figure/F",fig_num, sep="")
dir.create(fig_path, showWarnings = FALSE, recursive = TRUE)
ggsize <- c(2.1,2.25)
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
ggsize <- c(2.25,2.1)
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
ggsize <- c(2.25,2.15)
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.5) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
g1
print(g1)
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.3, alpha = 0.8, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.8, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.8, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.8, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.8, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
1.76/2
# Log2 FC Plot
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.6, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean Count") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# Linear FC Plot
g2 <- ggplot(data = df_gene, aes(x = baseMean, y = FoldChange)) +
geom_hline(yintercept = 1, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.6, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g2
save_plot(paste(fig_path, '/', "B_ma_fc_plot.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# MAD-FC Plot
g3 <- ggplot(data = df_gene, aes(x = baseMean, y = mcFoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.6, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab("MAD-FC") +
xlab("Normalized Mean") +
theme(legend.position = "none")
g3
save_plot(paste(fig_path, '/', "C_ma_mad-fc_plot.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# Log2 FC Plot
g1 <- ggplot(data = df_gene, aes(x = baseMean, y = log2FoldChange)) +
geom_hline(yintercept = 0, color = "grey") +
geom_point(aes(col=diffexpressed), size = 0.4, alpha = 0.6, shape = 16) +
scale_x_log10() +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
theme_classic(base_size = 8) +
ylab(expression(log[2]~(FC))) +
xlab("Normalized Mean Count") +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_ma_log2_plot.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
source("~/GitHub/mirrored_axis_distortion/set_wd_here.R", echo=TRUE)
source("~/GitHub/mirrored_axis_distortion/mirror_fc/F3_volcano_plot2.R", echo=TRUE)
source("~/GitHub/mirrored_axis_distortion/mirror_fc/F3_volcano_plot2.R", echo=TRUE)
df_gene <- data.frame( name = rownames(res), log2FoldChange = res$log2FoldChange,
FoldChange = 2^res$log2FoldChange, pvalue = res$pvalue)
df_gene$diffexpressed <- "None"
# if log2Foldchange > 0.6 and pvalue < 0.05, set as "UP"
df_gene$diffexpressed[df_gene$log2FoldChange > 1 & df_gene$pvalue < 0.05] <- "Up"
# if log2Foldchange < -0.6 and pvalue < 0.05, set as "DOWN"
df_gene$diffexpressed[df_gene$log2FoldChange < -1 & df_gene$pvalue < 0.05] <- "Down"
df_gene$diffexpressed <- factor(df_gene$diffexpressed, ordered = TRUE, levels = c("Up", "None", "Down"))
df_gene$mcFoldChange <- contract1(fc_to_mfc(df_gene$FoldChange))
# Log2 Plot
g1 <- ggplot(data=df_gene, aes(x=log2FoldChange, y=-log10(pvalue))) +
geom_point(aes(col=diffexpressed), size = 0.5, alpha = 0.6, shape = 16) +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
coord_cartesian(clip = "off") +
theme_classic(base_size = 8) +
ylab(expression(-log[10]~(p-value))) +
xlab(expression(log[2]~(Fold~Change))) +
theme(legend.position = "none")
g1
save_plot(paste(fig_path, '/', "A_volcano_log2.png", sep = ""),
g1, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# Fold Change Linear Plot
g2 <- ggplot(data=df_gene, aes(x=FoldChange, y=-log10(pvalue))) +
geom_point(aes(col=diffexpressed), size = 0.5, alpha = 0.6, shape = 16) +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
coord_cartesian(clip = "off") +
theme_classic(base_size = 8)   +
ylab(expression(-log[10]~(p-value))) +
xlab("Fold Change") +
theme(legend.position = "none")
g1
g2
save_plot(paste(fig_path, '/', "B_volcano_FC.png", sep = ""),
g2, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
# Fold Change Linear Plot
g3 <- ggplot(data=df_gene, aes(x=mcFoldChange, y=-log10(pvalue))) +
geom_point(aes(col=diffexpressed), size = 0.5, alpha = 0.6, shape = 16) +
scale_color_manual(values=c("blue", "black", "red"), name = "Change") +
coord_cartesian(clip = "off") +
theme_classic(base_size = 8) +
ylab(expression(-log[10]~(p-value))) +
xlab("MAD Fold Change") +
theme(legend.position = "none") +
scale_x_continuous(breaks=c(c(-9, - 4, 0, seq(4,30,5))), expand = c(0,0)) +
scale_y_continuous(expand = c(0,0))
g3
g3 <- gg_revaxis_mfc(g3,'x', num_format = "fraction")
g3
save_plot(paste(fig_path, '/', "C_volcano_MFC.png", sep = ""),
g3, dpi = 600, base_height = ggsize[1],
base_width = ggsize[2])
source("~/GitHub/mirrored_axis_distortion/mirror_fc/F3_fc_interval_protein.R", echo=TRUE)
library(tidyverse)
source("R/mirrored_axis_distortion.R")
base_dir = "mirror_fc"
fig_num = "3"
fig_path = paste(base_dir,"/figure/F",fig_num, sep="")
dir.create(fig_path, showWarnings = FALSE, recursive = TRUE)
df0 <- read.csv(paste0(base_dir, "/gene_expression_intervals.csv"))
df <- pivot_longer(df0,cols = -c("X", "label"),
names_to = "color_pt",values_to = "fc") %>%
separate(color_pt, c("color", "pt"), '_') %>%
pivot_wider(names_from = pt, values_from = fc)
df$log2_hi <- log2(df$hi)
df$log2_mid <- log2(df$mid)
df$log2_lo <- log2(df$lo)
df$mfc_hi <- contract1(fc_to_mfc(df$hi))
df$mfc_mid <- contract1(fc_to_mfc(df$mid))
df$mfc_lo <- contract1(fc_to_mfc(df$lo))
# Log2 Plot
ggplot(data = df,aes(x=label, y = log2_mid, color = color)) +
geom_errorbar(aes(ymax = log2_hi, ymin = log2_lo), size = 1, width = .35,
position=position_dodge(width=0.4)) +
geom_point(size = 2, position=position_dodge(width=0.4)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="none") +
scale_color_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c("#1b9e77", "#d95f02", "#7570b3")) +
scale_shape_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c(18, 15, 17)) +
scale_y_continuous(expand = c(0,0)) +
xlab("") + ylab("Log2(FC) From Vehicle TX")
# FC Plot
ggplot(data = df,aes(x=label, y = mid, color = color, shape = color)) +
geom_errorbar(aes(ymax = hi, ymin = lo), size = 1, width = .35,
position=position_dodge(width=0.4)) +
geom_point(size = 2, position=position_dodge(width=0.4)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="none") +
scale_color_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c("#1b9e77", "#d95f02", "#7570b3")) +
scale_shape_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c(18, 15, 17)) +
scale_y_continuous(expand = c(0,0)) +
xlab("") + ylab("Fold-change From Vehicle TX")
# Log2 Plot
ggplot(data = df,aes(x=label, y = log2_mid, color = color)) +
geom_errorbar(aes(ymax = log2_hi, ymin = log2_lo), size = 1, width = .35,
position=position_dodge(width=0.4)) +
geom_point(size = 2, position=position_dodge(width=0.4)) +
theme_classic() +
theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1),
legend.position="none") +
scale_color_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c("#1b9e77", "#d95f02", "#7570b3")) +
scale_shape_manual(name = "Treatment", labels = c("MEKi", "PI3Ki", "MEKI:PI3Ki"), values = c(18, 15, 17)) +
scale_y_continuous(expand = c(0,0)) +
xlab("") + ylab("Log2(FC) From Vehicle TX")
